[Unit]
Description=Radarr Daemon
RequiresMountsFor=/tank/appdata/radarr /tank/media/downloads /tank/media/arr_suite/movies
Wants=network-online.target sabnzbdplus.service prowlarr.service
After=network-online.target sabnzbdplus.service prowlarr.service

[Service]
Type=simple
User=radarr
Group=media
UMask=0002
WorkingDirectory=/srv/radarr
RuntimeDirectory=radarr

ExecStart=/tank/appdata/radarr/app/Radarr -nobrowser -data=/srv/radarr/data

# Restart & shutdown behavior
Restart=on-failure
RestartSec=5s
KillMode=mixed
KillSignal=SIGINT
TimeoutStopSec=30s

# Journald
StandardOutput=journal
StandardError=journal
SyslogIdentifier=radarr
LogRateLimitIntervalSec=30s
LogRateLimitBurst=300

# Core hardening
NoNewPrivileges=true
PrivateTmp=true
PrivateDevices=true
ProtectSystem=strict
ProtectHome=true
ProtectClock=true
ProtectHostname=true
ProtectKernelTunables=true
ProtectKernelModules=true
ProtectKernelLogs=true
ProtectControlGroups=true
ProtectProc=invisible
ProcSubset=pid
RestrictSUIDSGID=true
LockPersonality=true
MemoryDenyWriteExecute=false
RestrictNamespaces=true
RestrictRealtime=true
SystemCallArchitectures=native
CapabilityBoundingSet=
AmbientCapabilities=
RestrictAddressFamilies=AF_INET AF_INET6 AF_UNIX
SystemCallErrorNumber=EPERM
SystemCallFilter=@system-service @basic-io @file-system @network-io @process @signal @memlock
SystemCallFilter=~ @mount @raw-io @reboot @swap @module @debug

# Bind Mounts
BindReadOnlyPaths=/tank/appdata/radarr/app:/srv/radarr/app
BindPaths=/tank/appdata/radarr/data:/srv/radarr/data
BindPaths=/tank/media/downloads:/srv/downloads
BindPaths=/tank/media/arr_suite/movies:/srv/movies

ReadWritePaths=/srv/radarr/data /srv/downloads /srv/movies

[Install]
WantedBy=multi-user.target
